---
import { env } from "cloudflare:workers";
import Layout from "@/layouts/Layout.astro";
import { HoursManager } from "@/components/HoursManager";
import { createContentClient, getHours } from "@/lib/content";

const client = createContentClient(env.PAYLOAD_CMS);
const hoursResult = await getHours(client);

// Transform hours for the component (capitalize day names)
const hours = hoursResult.map(h => ({
  id: h.id,
  day: h.day.charAt(0).toUpperCase() + h.day.slice(1),
  open: h.open || '08:00',
  close: h.close || '18:00',
  closed: h.closed || false,
}));
---

<Layout title="Business Hours" isAdmin>
  <div class="space-y-6">
    <div class="flex justify-between items-center">
      <h1 class="text-3xl font-black">Business Hours</h1>
      <a href="/admin" class="btn btn-ghost btn-sm gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path d="m15 18-6-6 6-6"/></svg>
        Back to Dashboard
      </a>
    </div>
    <div class="card bg-base-100 shadow-xl">
      <div class="card-body">
        <HoursManager initialHours={hours} client:load />
      </div>
    </div>
  </div>
</Layout>
